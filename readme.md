# 1C 7.7 Configuration Parser (MD Parser)

–õ–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –Ω–∞ C++ (Win32 API) –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ **1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ 7.7** (`1cv7.md`).

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö (ZLib), —Å–Ω–∏–º–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —É–¥–æ–±–Ω–æ–º –≤–∏–¥–µ.

![–°—Ç–∞—Ç—É—Å](https://img.shields.io/badge/Platform-Windows_Server_2003_Compatible-blue.svg)
![–Ø–∑—ã–∫](https://img.shields.io/badge/Language-C%2B%2B_%2F_Win32_API-green.svg)
![–õ–∏—Ü–µ–Ω–∑–∏—è](https://img.shields.io/badge/License-MIT-orange.svg)

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ. –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ.
* **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ù–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ —á–∏—Å—Ç–æ–º Win32 API, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –û–° (Windows Server 2003 / XP) –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ Windows 10/11.
* **–ü—Ä–æ—Å–º–æ—Ç—Ä OLE —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–ø–∞–ø–∫–∏ –∏ –ø–æ—Ç–æ–∫–∏).
* **–ü–∞—Ä—Å–∏–Ω–≥ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–±–æ—Ä –ø–æ—Ç–æ–∫–∞ `Main MetaData Stream`.
    * –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ (–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏, –î–æ–∫—É–º–µ–Ω—Ç—ã, –†–µ–≥–∏—Å—Ç—Ä—ã –∏ —Ç.–¥.).
    * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö ID –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π.
* **–î–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è –∏ –î–µ—à–∏—Ñ—Ä–æ–≤–∫–∞:**
    * –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Å–∂–∞—Ç–∏—è ZLib.
    * –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ –¥–ª—è 1–° —Å–º–µ—â–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.
    * –°–Ω—è—Ç–∏–µ XOR-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (—Å–∏–≥–Ω–∞—Ç—É—Ä–∞ `%w`) –Ω–∞ –ª–µ—Ç—É.
* **GUI:** –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —á—Ç–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ `.md`:

1.  **OLE Structured Storage:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `StgOpenStorage` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ—Å—Ç–∞–≤–Ω—ã–º —Ñ–∞–π–ª–∞–º.
2.  **–î–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `miniz` (tinfl) –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ Deflate/ZLib.
3.  **–ü–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–∞ 1–°:** –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫ –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Å–∫–æ–±–æ–∫ `{"Key", {"Value", ...}}`.
4.  **–ê–Ω–∞–ª–∏–∑ —Ç–∏–ø–æ–≤:** –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏—Ö —Ç–∏–ø–∞–º–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–Ω—è—Ç–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.

## üöÄ –°–±–æ—Ä–∫–∞

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Å–±–æ—Ä–∫–∏ —á–µ—Ä–µ–∑ **NMAKE** (MSVC).

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
* Visual Studio (–ª—é–±–∞—è –≤–µ—Ä—Å–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++) –∏–ª–∏ Build Tools.
* –í–∫–ª—é—á–µ–Ω–Ω—ã–π –≤ –ø—Ä–æ–µ–∫—Ç —Ñ–∞–π–ª `miniz.c` (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Makefile).

### –ö–æ–º–∞–Ω–¥—ã
–û—Ç–∫—Ä–æ–π—Ç–µ **Developer Command Prompt for VS** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```cmd
nmake
–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª parser.exe.

–î–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (.obj):

DOS

nmake clean
üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å—Ç–∏—Ç–µ parser.exe.

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ù–∞—Å—Ç—Ä–æ–π–∫–∏.

–ù–∞–∂–º–∏—Ç–µ –û–±–∑–æ—Ä... –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ 1cv7.md.

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª:

–í–∫–ª–∞–¥–∫–∞ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ("—Å—ã—Ä—ã–µ" –¥–∞–Ω–Ω—ã–µ).

–í–∫–ª–∞–¥–∫–∞ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π —É–∑–µ–ª –¥–µ—Ä–µ–≤–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏.

–ö–Ω–æ–ø–∫–∞ –°–ø—Ä–∞–≤–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ.

üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
main.cpp ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –æ–∫–æ–Ω, –ª–æ–≥–∏–∫–∞ GUI (–≤–∫–ª–∞–¥–∫–∏, –¥–µ—Ä–µ–≤–æ).

MDParser.cpp ‚Äî –õ–æ–≥–∏–∫–∞ —á—Ç–µ–Ω–∏—è OLE, –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è, –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

MDParser.h ‚Äî –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö.

miniz.c / miniz.h ‚Äî –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–∂–∞—Ç–∏–µ–º.

Makefile ‚Äî –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏.

ü§ù –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
miniz ‚Äî Single-file zlib-subset library (Public Domain / MIT).

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –∫–æ–¥.